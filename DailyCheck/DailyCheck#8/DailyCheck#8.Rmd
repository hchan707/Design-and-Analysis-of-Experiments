---
title: "Daily Check 8"
output: pdf_document
date: "2025-04-23"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown
## Question: Daily Check 8
Answer this question: After running an ANOVA and obtaining a statistically significant p-value, we might want to know exactly WHICH means are different from each other. As discussed in class and in our textbook, why would it be a bad idea to simply do t-tests on each pair of means?

Also complete the two Your Turns, put all of this into an R Markdown file and submit both your pdf output and Rmd files. 

Answer this question: After running an ANOVA and obtaining a statistically significant
p-value, we might want to know exactly WHICH means are different from each other. As
discussed in class and in our textbook, why would it be a bad idea to simply do t-tests
on each pair of means?

It is a bad idea to simply do t-tests on each pair of means after a significant ANOVA
because doing so does not control the experiment wise error rate. When you perform
multiple t-tests, the probability of making at least one Type I error increases with the
number of comparisons you make. This means you are more likely to incorrectly
conclude that a difference exists when it actually does not. Instead, you should use
special multiple comparison procedures that are designed to control the overall Type I
error rate when making several pairwise comparisons.

```{r cars}
google <- c(46, 49, 51, 42)
waze <- c(44, 47, 47, 43)
gut <- c(50, 51, 45, 43)
nav_df <- data.frame(
time = c(google, waze, gut),
method = c(rep("google", length(google)),
rep("waze", length(waze)),
rep("gut", length(gut)))
)
```

```{r}
pan <- c(12.70, 12.30, 12.40, 12.80, 12.60,
12.50, 12.20, 12.70, 12.40, 12.60)
grilled <- c(11.80, 11.55, 11.75, 11.65, 11.50,
11.75, 11.30, 12.10, 11.50, 11.45)
broiled <- c(11.75, 11.85, 11.60, 11.80, 11.75,
11.65, 11.75, 11.70, 11.85, 11.75)
burgers_df <- data.frame(
sat_fat = c(pan, grilled, broiled),
method = c(rep("pan", length(pan)),
rep("grilled", length(grilled)),
rep("broiled", length(broiled)))
)
```

```{r}
sample(nav_df$time)
```

```{r}
set.seed(10242024)
nav_perm <- nav_df # temporarily copy the whole df
nav_perm$time <- sample(nav_perm$time)
perm_anova <- aov(time ~ method, data=nav_perm)
summary(perm_anova)

```

```{r}
names(perm_anova)
```
```{r}
summary(perm_anova)[[1]][1,4]
```
```{r}
# Create a vector to store the F values
perm_f <- NA
# set the number of replications
reps <- 10000
# do it lots of times in a loop
for(i in 1:reps){
nav_perm <- nav_df
nav_perm$time <- sample(nav_perm$time)
perm_f[i] <- summary(aov(time ~ method, data=nav_perm))[[1]][1,4]
}
```

```{r}
summary(aov(time ~ method, data=nav_df))[[1]][1,4]

```

```{r}
F <- summary(aov(time ~ method, data=nav_df))[[1]][1,4]

sum(perm_f >= F)/reps
```

## Your Turn #1
```{r}
set.seed(4232025)
data(PlantGrowth)

#Create a vector to store the F values
perm_f <- NA
# set reps
reps <- 10000
#do it lots of times
for(i in 1: reps)
{
  plant_perm <- PlantGrowth
  plant_perm$weight <- sample(plant_perm$weight)
  perm_f[i] <- summary(aov(weight ~ group, data=plant_perm))[[1]][1,4]
}
F <- summary(aov(weight ~ group, data=PlantGrowth))[[1]][1,4]
sum(perm_f >= F)/reps
```

Here is the ANOVA analysis:
```{r}
model1 <- aov(weight ~ group, data = PlantGrowth)
summary(model1)
```
```{r}
library(dplyr)
summary <- burgers_df %>% group_by(method) %>%
summarize(means=mean(sat_fat))
print(summary)
```

```{r}
summary(aov(sat_fat ~ method, data=burgers_df))
q <- abs(summary$means[1] - summary$means[2]) / sqrt(summary(aov(sat_fat~method, data = burgers_df))[[1]][2,3]/10)
print(q)
ptukey(q, nmeans=3, df=27, lower.tail=FALSE)
```
##Your Turn 2


```{r, message = FALSE}
library(dplyr)
summary <- PlantGrowth %>% group_by(group) %>% summarize(means = mean(weight))

print(summary)

q <- abs(summary$means[2] - summary$means[3]) / sqrt(summary(aov(weight ~ group, data = PlantGrowth))[[1]][2,3]/10)

ptukey(q, nmeans = 3, df = 27, lower.tail = FALSE)
```
All pairwise p-values: 
```{r}
TukeyHSD(model1)
```
## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
